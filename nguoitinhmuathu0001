-- LuckyBuff Full Script (All-in-One)
-- Place: StarterGui > LocalScript
-- Made by: toxic_white

--// CONFIG
local BUFF_MULTIPLIER = 9        -- x9 buff
local BUFF_DURATION = 3600       -- 1h
local COOLDOWN = 7200            -- 2h
local BLACKSCREEN_DURATION = 300 -- 5 phút = 300s
local WEBHOOK_URL = "https://discord.com/api/webhooks/1401785416104939720/6LU4HbxLm8mwoS8iZ0LrbwBmZ1Wp6clskoXsEGtnymrKNLVDTeVPZbpeBKKom9wrWG6Z" -- <== ĐỔI LINK CỦA BẠN

--// SERVICES
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

--// RemoteEvent
local remoteName = "RequestLuckyBuff"
local Remote = ReplicatedStorage:FindFirstChild(remoteName)
if not Remote then
    Remote = Instance.new("RemoteEvent")
    Remote.Name = remoteName
    Remote.Parent = ReplicatedStorage
end

--// UI SETUP
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "LuckyBuffGUI"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

-- Card UI
local card = Instance.new("Frame")
card.Size = UDim2.new(0, 360, 0, 180)
card.Position = UDim2.new(0.5, -180, 0.5, -90)
card.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
card.BorderSizePixel = 0
card.Parent = screenGui

local title = Instance.new("TextLabel", card)
title.Size = UDim2.new(1, -20, 0, 30)
title.Position = UDim2.new(0, 10, 0, 10)
title.Text = "BUFF LUCKY SV x9"
title.TextColor3 = Color3.fromRGB(255, 255, 0)
title.TextScaled = true
title.BackgroundTransparency = 1

local desc = Instance.new("TextLabel", card)
desc.Size = UDim2.new(1, -20, 0, 25)
desc.Position = UDim2.new(0, 10, 0, 45)
desc.Text = "Tăng may mắn x9 trong 60 phút!"
desc.TextColor3 = Color3.fromRGB(255, 255, 255)
desc.TextScaled = true
desc.BackgroundTransparency = 1

local timeLabel = Instance.new("TextLabel", card)
timeLabel.Size = UDim2.new(1, -20, 0, 25)
timeLabel.Position = UDim2.new(0, 10, 0, 75)
timeLabel.Text = "Số thời gian còn lại: 0s"
timeLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
timeLabel.TextScaled = true
timeLabel.BackgroundTransparency = 1

local toggleBtn = Instance.new("TextButton", card)
toggleBtn.Size = UDim2.new(0, 100, 0, 35)
toggleBtn.Position = UDim2.new(0.5, -50, 1, -45)
toggleBtn.Text = "ON"
toggleBtn.TextScaled = true
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)

local madeBy = Instance.new("TextLabel", card)
madeBy.Size = UDim2.new(1, -10, 0, 20)
madeBy.Position = UDim2.new(0, 5, 1, -20)
madeBy.Text = "Made by: toxic_white"
madeBy.TextColor3 = Color3.fromRGB(150, 150, 150)
madeBy.TextXAlignment = Enum.TextXAlignment.Right
madeBy.BackgroundTransparency = 1

-- BlackScreen UI
local blackScreen = Instance.new("Frame", screenGui)
blackScreen.Size = UDim2.new(1, 0, 1, 0)
blackScreen.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
blackScreen.ZIndex = 50
blackScreen.Visible = false

--// LOGIC
local running = false
local cooldown = false
local timeLeft = 0

-- Countdown
local function startCountdown(sec)
    timeLeft = sec
    while timeLeft > 0 and running do
        local m = math.floor(timeLeft/60)
        local s = timeLeft % 60
        timeLabel.Text = string.format("Số thời gian còn lại: %d:%02d", m, s)
        task.wait(1)
        timeLeft -= 1
    end
    if running then
        timeLabel.Text = "Hết Buff"
        toggleBtn.Text = "ON"
        running = false
    end
end

-- Button click
toggleBtn.MouseButton1Click:Connect(function()
    if not running and not cooldown then
        Remote:FireServer("Start")
        toggleBtn.Text = "Đang khởi..."
        toggleBtn.Active = false
    elseif running then
        Remote:FireServer("Stop")
        toggleBtn.Text = "Tắt..."
        toggleBtn.Active = false
    end
end)

-- Nhận Event từ server
Remote.OnClientEvent:Connect(function(cmd, data)
    if cmd == "BuffOn" then
        running = true
        cooldown = false
        toggleBtn.Active = true
        toggleBtn.Text = "OFF"
        spawn(function() startCountdown(data) end)
    elseif cmd == "BuffOff" then
        running = false
        toggleBtn.Text = "ON"
        toggleBtn.Active = true
    elseif cmd == "Cooldown" then
        cooldown = true
        local remain = data or 0
        toggleBtn.Active = false
        spawn(function()
            while remain > 0 do
                toggleBtn.Text = "Cooldown: "..remain.."s"
                task.wait(1)
                remain -= 1
            end
            cooldown = false
            toggleBtn.Text = "ON"
            toggleBtn.Active = true
        end)
    elseif cmd == "ShowBlackScreen" then
        blackScreen.Visible = true
        delay(data or 300, function()
            blackScreen.Visible = false
        end)
    end
end)
print("[LuckyBuff] GUI Loaded. Made by toxic_white")
